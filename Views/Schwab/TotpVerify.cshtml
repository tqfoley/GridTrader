@{
    ViewData["Title"] = "Verify Authentication Code";
}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0 text-center">Two-Factor Authentication</h3>
                </div>
                <div class="card-body">
                    <div class="text-center mb-4">
                        <i class="bi bi-shield-lock" style="font-size: 4rem; color: #0d6efd;"></i>
                        <p class="mt-3">Enter the 6-digit code from your Google Authenticator app</p>
                    </div>

                    @if (ViewBag.Error != null)
                    {
                        <div class="alert alert-danger">
                            @ViewBag.Error
                        </div>
                    }

                    <form method="post" action="@Url.Action("VerifyTotpCode", "Schwab")">
                        <div class="mb-3">
                            <label for="code" class="form-label text-center d-block">Authenticator Code</label>
                            <input type="text" class="form-control form-control-lg text-center" id="code" name="code"
                                   maxlength="6" pattern="[0-9]{6}" required autocomplete="off"
                                   placeholder="000000" style="letter-spacing: 0.5em; font-size: 2rem;" autofocus />
                        </div>
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">Verify</button>
                            @* TOTP SETUP DISABLED - Commented out reconfigure button
                            <a href="@Url.Action("TotpSetup", "Schwab")" class="btn btn-outline-secondary">
                                Reconfigure Authenticator
                            </a>
                            *@
                        </div>
                    </form>

                    <div class="mt-4 text-center">
                        <small class="text-muted">
                            Don't have access to your authenticator? Contact your administrator.
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Auto-submit when 6 digits are entered
    document.getElementById('code').addEventListener('input', function(e) {
        var value = e.target.value.replace(/\D/g, '');
        e.target.value = value;
        if (value.length === 6) {
            e.target.form.submit();
        }
    });

    // Auto-focus on the input field
    window.onload = function() {
        document.getElementById('code').focus();
    };
</script>
